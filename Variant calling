The tools used to call variants

Several tools can be used for variant calling (GATK, Samtools, Freebayes). One of the most common outputs of variant calling is the variant call format (VCF). 
A VCF is a tab-delimited text, parsable by standard UNIX commands and can be compressed with BGZF (bgzip) and indexed with TBI or CSI (tabix).

An overview of key fields found in a VCF file include: (https://ugc.futurelearn.com/uploads/assets/fc/03/hero_fc035324-235a-4750-a3cb-f232aec85592.png)

CHROM: Chromosome or contig name where the variant is located.

POS: Position of the variant on the chromosome or contig.

ID: A unique identifier for the variant, often used to link to external databases.

REF: The reference allele, representing the genomic base at the specified position in the reference genome.

ALT: The alternate allele(s), indicating the variant base(s) observed in the sample(s). Multiple alternate alleles can be represented.

QUAL: Quality score representing the confidence or quality of the variant call.

FILTER: Information about any filters or criteria used to determine the variant call, showing whether the variant met quality standards or particular significance thresholds.

INFO: A field containing additional information about the variant.
It includes various subfields denoted by key-value pairs, such as allele frequency, functional annotations, and predicted effects.

FORMAT: Defines the structure of sample-specific genotype and variant information. 
Specifies which fields are present for each sample, such as genotype quality (GQ), allele depth (AD), and more.

SAMPLE Genotype Fields: These fields provide genotype information for each sample at the variant position. 
Genotypes indicate the combination of alleles carried by each sample, often using numerical codes 
(e.g., 0/0 for homozygous reference, 0/1 for heterozygous, 1/1 for homozygous alternate).

In the previous section we mapped our sample to the reference genome. Here, we will call variants from the BAM file using FreeBayes. 
First we need to index the reference genome using samtools:

                                                    samtools faidx MN908947.fasta

Now, let’s use FreeBayes to identify the variants in our test sample:

                                                        freebayes -f MN908947.fasta Mapping/ERR5743893.sorted.bam  > ERR5743893.vcf
Finally, it’s good practice to compress and index the VCF file so it takes up less space. 
Most tools will accept compressed VCF files so there’s no need to uncompress them later.

                                                     bgzip ERR5743893.vcf
                                                      tabix ERR5743893.vcf.gz


Yes — bgzip and tabix are designed to work together in genomics pipelines. Let me explain the flow clearly.

1. bgzip

Compresses a VCF file (or any text-based genomic file) into a special indexed-friendly gzip format:

bgzip ERR5743893.vcf
# produces ERR5743893.vcf.gz


Normal gzip creates a file that cannot be efficiently indexed for random access. bgzip allows jumping directly to specific genomic regions without decompressing the whole file.

2. tabix

Creates an index for a bgzip-compressed file.

For VCFs:

tabix -p vcf ERR5743893.vcf.gz
# creates ERR5743893.vcf.gz.tbi


The index (.tbi) allows tools like bcftools, IGV, or FreeBayes downstream to quickly fetch variants in a region, e.g., chr1:10000-20000.

3. Typical workflow
# 1. Variant calling produces VCF
freebayes -f Reference.fasta Mapping/ERR5743893.sorted.bam > ERR5743893.vcf

# 2. Compress VCF for indexing
bgzip ERR5743893.vcf

# 3. Index the compressed VCF
tabix -p vcf ERR5743893.vcf.gz

# 4. Query or use in downstream tools
bcftools view ERR5743893.vcf.gz chr1:1000-5000


✅ Summary

bgzip compresses the file in a format suitable for indexing.

tabix indexes it so genomic tools can quickly query by region.

Alone, bgzip just compresses; alone, tabix won’t work on uncompressed VCFs. Together, they are a standard combination in genomics.

If you want, I can draw a diagram of the full VCF workflow from BAM → VCF → bgzip → tabix → region queries — it makes it very clear how the pieces fit together.

You said:
how to unzip to view on github
